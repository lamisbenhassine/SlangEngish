<div class="profile-container" *ngIf="user as user">
  <div class="profile-header">
    <h1>My Profile</h1>
  </div>

  <div class="profile-content">
    <div class="profile-card">
      <div class="user-info-card">
        <div class="user-avatar">
          <img [src]="user.avatar || 'https://via.placeholder.com/140x140/667eea/ffffff?text=' + user.firstName.charAt(0) + user.lastName.charAt(0)" [alt]="user.firstName + ' ' + user.lastName">
          <button mat-fab class="avatar-edit" color="primary">
            <mat-icon>camera_alt</mat-icon>
          </button>
        </div>
        <div class="user-details">
          <h2>{{ user.firstName }} {{ user.lastName }}</h2>
          <p>{{ user.email }}</p>
          <span class="role">{{ user.role }}</span>
        </div>
      </div>
    </div>

    <div class="profile-form">
      <mat-card>
        <mat-card-content>
          <h3>Edit Profile Information</h3>
          <form class="profile-form-content">
            <div class="form-row">
              <mat-form-field appearance="outline" class="form-field">
                <mat-label>First Name</mat-label>
                <input matInput [(ngModel)]="user.firstName" name="firstName">
                <mat-icon matSuffix>person</mat-icon>
              </mat-form-field>
              <mat-form-field appearance="outline" class="form-field">
                <mat-label>Last Name</mat-label>
                <input matInput [(ngModel)]="user.lastName" name="lastName">
                <mat-icon matSuffix>person</mat-icon>
              </mat-form-field>
            </div>

            <mat-form-field appearance="outline" class="form-field full-width">
              <mat-label>Email</mat-label>
              <input matInput [(ngModel)]="user.email" name="email" type="email">
              <mat-icon matSuffix>email</mat-icon>
            </mat-form-field>

            <mat-form-field appearance="outline" class="form-field full-width">
              <mat-label>Phone</mat-label>
              <input matInput [(ngModel)]="user.phone" name="phone">
              <mat-icon matSuffix>phone</mat-icon>
            </mat-form-field>

            <mat-form-field appearance="outline" class="form-field full-width">
              <mat-label>Address</mat-label>
              <textarea matInput [(ngModel)]="user.address" name="address" rows="3"></textarea>
              <mat-icon matSuffix>location_on</mat-icon>
            </mat-form-field>

            <div class="form-actions">
              <button mat-raised-button color="primary" (click)="saveProfile()">
                <mat-icon>save</mat-icon>
                Save Changes
              </button>
              <button mat-button (click)="cancelEdit()">
                Cancel
              </button>
            </div>
          </form>
        </mat-card-content>
      </mat-card>

      <mat-card class="password-card">
        <mat-card-content>
          <h3>Change Password</h3>
          <form class="password-form">
            <mat-form-field appearance="outline" class="form-field full-width">
              <mat-label>Current Password</mat-label>
              <input matInput [(ngModel)]="passwordData.current" name="current" type="password">
              <mat-icon matSuffix>lock</mat-icon>
            </mat-form-field>

            <mat-form-field appearance="outline" class="form-field full-width">
              <mat-label>New Password</mat-label>
              <input matInput [(ngModel)]="passwordData.new" name="new" type="password">
              <mat-icon matSuffix>lock_outline</mat-icon>
            </mat-form-field>

            <mat-form-field appearance="outline" class="form-field full-width">
              <mat-label>Confirm New Password</mat-label>
              <input matInput [(ngModel)]="passwordData.confirm" name="confirm" type="password">
              <mat-icon matSuffix>lock_outline</mat-icon>
            </mat-form-field>

            <div class="form-actions">
              <button mat-raised-button color="warn" (click)="changePassword()">
                <mat-icon>lock</mat-icon>
                Change Password
              </button>
            </div>
          </form>
        </mat-card-content>
      </mat-card>
    </div>
  </div>
</div>

<div class="profile-container" *ngIf="!user">
  <div class="profile-header">
    <h1>My Profile</h1>
  </div>
  <mat-card>
    <mat-card-content>
      <p>Please sign in to view your profile.</p>
    </mat-card-content>
  </mat-card>
</div>
